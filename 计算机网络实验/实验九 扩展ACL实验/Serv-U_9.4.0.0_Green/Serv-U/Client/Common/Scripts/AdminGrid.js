function lqp(wnw,trm,tbd,djvb,rsq,xnv,xdp,kkk,zkj){var wqhb=new AW.UI.SUAdminGrid(wnw,trm,tbd,zkj);if(wqhb!=undefined){wqhb.m_XMLTable=new AW.XML.GridTable(rsq);wqhb.setCellModel(wqhb.m_XMLTable);wqhb.m_sXMLFile=wqhb.m_sOrigXMLFile=djvb;wqhb.m_sDataNodeName=xnv;wqhb.m_nNumColumns=xdp;wqhb.onRowDoubleClicked=kkk;wqhb.m_nDeleteColumn=(xdp-1);wqhb.m_nIDCol=wqhb.m_nDeleteColumn;wqhb.m_sIDCol="ID";wqhb.m_ColumnNoResize=[];wqhb.setEvent("oncontextmenu","return false");wqhb.refresh();xzgb(wqhb);}return(wqhb);}function kky(wqhb,qwgb){wqhb.Reset(qwgb);}function ypr(wqhb){wqhb.MoveObject(cqqb+"Result.xml&Command=MoveTopObject&Object");}function mrlb(wqhb){wqhb.MoveObject(cqqb+"Result.xml&Command=MoveUpObject&Object");}function lndb(wqhb){wqhb.MoveObject(cqqb+"Result.xml&Command=MoveDownObject&Object");}function cbkb(wqhb){wqhb.MoveObject(cqqb+"Result.xml&Command=MoveBottomObject&Object");}AW.UI.SUAdminGrid=AW.UI.SUBasicGrid.subclass();AW.UI.SUAdminGrid.create=function(){var gzl=this.prototype;var zjz=this.superclass.prototype;gzl.init=function(wnw,trm,tbd,ycl){zjz.init.call(this,wnw,trm,tbd);var qdrb=0;if(ycl!=undefined)qdrb=ycl;this.setSortColumn(qdrb);this.setSortDirection("ascending",qdrb);this.m_nEditObjectID=-1;this.m_bInitialUpdate=true;this.m_nTimerMS=1000;this.m_DisableMove=false;this.m_bFilterMode=false;this.m_bAllowEmpty=false;};gzl.NoResizeColumns=function(fmq){this.m_ColumnNoResize=fmq;};gzl.RightAlignColumn=function(kpx,lbfb){var nfg=new AW.Templates.Text;nfg.setStyle("text-align","right");this.setCellTemplate(nfg,kpx);if(lbfb)this.getHeaderTemplate(kpx).setStyle("text-align","right");};gzl.ChangeURL=function(xtl){this.m_sXMLFile=this.m_sOrigXMLFile=xtl;};gzl.EnableUpdates=function(wfwb,tkjb,hjr,slfb){if((tkjb!=undefined)&&(hjr!=undefined))this.m_sXMLFile=this.m_sOrigXMLFile.replace(tkjb,hjr);if(slfb)this.m_sOrigXMLFile=this.m_sXMLFile;if((wfwb)&&(!this.m_bUpdates))this.m_nTimeout=this.setTimeout(this.TimeoutFunc,this.m_nTimerMS);else if(!wfwb)clearTimeout(this.m_nTimeout);this.m_bUpdates=wfwb;};gzl.TimeoutFunc=function(){var djnb=(this.m_bInitialUpdate)?"&ForceList=1":"";this.m_XMLTable.setURL(this.m_sXMLFile+djnb);this.m_XMLTable.request();};gzl.ForceUpdate=function(tkjb,hjr){this.m_bForceUpdate=true;if((tkjb!=undefined)&&(hjr!=undefined))this.m_sXMLFile=this.m_sOrigXMLFile.replace(tkjb,hjr);this.TimeoutFunc();};gzl.PreUpdateDef=gzl.PreUpdate;gzl.PreUpdate=function(){var ywl=true;var ncd=zpq(this.m_XMLTable.getResponseXML(),"listresult");this.PreUpdateDef();if(!((this.m_bUpdates)||(this.m_bForceUpdate)))ywl=false;else if((this.m_XMLTable.getCount()==1)&&(this.m_XMLTable.getResponseText()=="")){this.setTimeout(this.ForceUpdate);ywl=false;}else if((ncd!=undefined)&&(ncd!=0)){if(ncd==800)this.ResetTimer();ywl=false;}else this.PreserveRowState();this.m_bUpdating=ywl;return(ywl);};gzl.PostUpdateDef=gzl.PostUpdate;gzl.PostUpdate=function(){this.RestoreRowState();this.PostUpdateDef();if(this.m_bSaving)pq(this.m_bSaving=false);this.m_bInitialUpdate=false;this.ResetTimer();this.m_bUpdating=false;};gzl.PreserveRowState=function(){this.m_nCurrentObj=(this.getCurrentRow()>=0)?this.getCellData(this.m_nIDCol,this.getCurrentRow()):-1;if(((this.m_anSelectedObjects=this.getSelectedRows()).length)&&(this.m_anSelectedObjects[0]!=-1)){for(var ykqb=0;ykqb<this.m_anSelectedObjects.length;ykqb++)this.m_anSelectedObjects[ykqb]=this.getCellData(this.m_nIDCol,this.m_anSelectedObjects[ykqb]);this.m_nScrollLeft=this.getScrollLeft();this.m_nScrollTop=this.getScrollTop();}else this.m_anSelectedObjects=undefined;};gzl.RestoreRowState=function(){var qqv=new Array();this.m_bRestoredCurrent=false;if((this.m_anSelectedObjects!=undefined)&&(this.m_anSelectedObjects.length)){for(var ykqb=0;ykqb<this.m_anSelectedObjects.length;ykqb++){var bgq;var qg=this.m_XMLTable.selectNodes("//"+this.m_sDataNodeName+"["+this.m_sIDCol+"='"+this.m_anSelectedObjects[ykqb]+"']");if((qg.length==1)&&((bgq=this.m_XMLTable.selectNodes("./@listitem",qg[0])).length==1)){var xwf=(AW.ie)?parseInt(bgq[0].text):parseInt(bgq[0].textContent);this.setRowSelected(true,xwf);qqv.push(xwf);if(this.m_anSelectedObjects[ykqb]==this.m_nCurrentObj){this.setCurrentRow(xwf);this.m_nCurrentObj=-1;this.m_bRestoredCurrent=true;}}}this.setSelectedRows(qqv);this.m_anSelectedObjects=undefined;}};gzl.ResetCurrentRowDef=gzl.ResetCurrentRow;gzl.ResetCurrentRow=function(){if(!this.m_bRestoredCurrent)this.setTimeout(this.ResetCurrentRowDef);else this.setTimeout(this.ResetCurrentRowTimeout);};gzl.ResetCurrentRowTimeout=function(){this.setScrollLeft(this.m_nScrollLeft);this.setScrollTop(this.m_nScrollTop);this.m_nScrollLeft=this.m_nScrollTop=0;};gzl.ResetTimer=function(){if((!this.m_bForceUpdate)&&(this.m_bUpdates))this.m_nTimeout=this.setTimeout(this.TimeoutFunc,this.m_nTimerMS);else this.m_bForceUpdate=false;};gzl.EditObject=function(ykc,rdl,ybs,xyfb,Form,lns,jvy,glc,qyj,ncf,xtpb){var syj=new AW.XML.SUObjectTable(ykc,rdl);if(syj!=undefined){if(ybs)syj.setRequestMethod("POST");if(jvy!=undefined){if((jvy.length>=1)&&(jvy[0]!=undefined)){this.m_fnOnFillFormCallback=jvy[0];syj.m_fnOnFillForm=this.OnFillFormCallback;syj.m_OnFillFormObj=this;}if((jvy.length>=2)&&(jvy[1]!=undefined))syj.m_fnDialogDismissal=jvy[1];}if((glc!=undefined)&&(glc)){this.m_fnOnFillFormCallback=this.CheckErrorState;syj.m_fnOnFillForm=this.OnFillFormCallback;syj.m_OnFillFormObj=this;syj.m_bCheckError=true;}syj.FillForm(Form,lns,qyj,xtpb);}this.m_nEditObjectID=rdl;this.m_sDialog=lns;this.m_Form=Form;this.m_sSaveURL=xyfb;};gzl.OnFillFormCallback=function(wqhb,syj){wqhb.UpdateEditObjectID(wqhb,syj);if(wqhb.m_fnOnFillFormCallback!=undefined)wqhb.m_fnOnFillFormCallback(wqhb,syj);};gzl.UpdateEditObjectID=function(wqhb,syj){var qg=syj.GetCollectionByAttrib("var","name","ObjectID");if((qg!=undefined)&&(qg.length>0)){var dfdb=syj.GetNodeValue(qg[0],"val");if(dfdb!=undefined){var rdl=parseInt(dfdb);wqhb.m_nEditObjectID=rdl;if(wqhb.m_sSaveURL.charAt(wqhb.m_sSaveURL.length-1)=='.')wqhb.m_sSaveURL+=rdl;}}};gzl.OnSaveObject=function(qnsb,hhjb,hhhb){var syj=new AW.XML.SUObjectTable(this.m_sSaveURL,((this.m_bNewObject)?-1:((this.m_bTempEdit)?this.m_nOriginalEditID:this.m_nEditObjectID)));if(syj!=undefined)syj.SubmitForm(this.m_Form,this.m_sDialog,qnsb,hhjb,hhhb);};gzl.OnAddObject=function(ykc,xyfb,Form,lns,jvy,glc,qyj,xtpb){this.m_bNewObject=true;this.EditObject(ykc,0,true,xyfb,Form,lns,jvy,glc,qyj,undefined,xtpb);};gzl.OnEditObject=function(ykc,xyfb,Form,lns,rlgb,gvj,jvy,lccb,pxrb,qyj,ncf,xtpb){if(!pxrb){if((this.getSelectedRows()!="")&&(this.getSelectedRows()!=-1)){var hqc=new Array();hqc=this.getSelectedRows().toString().split(",");if(hqc.length==1)pxrb=parseInt(this.getCellData((this.m_nNumColumns-1),hqc[0]));else{if(xtpb)pq(false);slc(rlgb);}}else{if(xtpb)pq(false);slc(gvj);}}if(pxrb){var rdl=-1;this.m_bNewObject=false;this.m_nOriginalEditID=pxrb;if(lccb)ykc+=this.m_nOriginalEditID;else{rdl=this.m_nOriginalEditID;if(ncf==undefined||!ncf)xyfb+=rdl;}this.m_bTempEdit=lccb;this.EditObject(ykc,rdl,false,xyfb,Form,lns,jvy,undefined,qyj,ncf,xtpb);}};gzl.OnCopyObject=function(ykc,xyfb,Form,lns,rlgb,gvj,jvy,lccb,pxrb){if(!pxrb){if((this.getSelectedRows()!="")&&(this.getSelectedRows()!=-1)){var hqc=new Array();hqc=this.getSelectedRows().toString().split(",");if(hqc.length==1)pxrb=parseInt(this.getCellData((this.m_nNumColumns-1),hqc[0]));else slc(rlgb);}else slc(gvj);}if(pxrb){var rdl=-1;this.m_bNewObject=true;this.m_nOriginalEditID=pxrb;if(lccb)ykc+=this.m_nOriginalEditID;else{rdl=this.m_nOriginalEditID;xyfb+=rdl;}this.m_bTempEdit=lccb;this.EditObject(ykc,-1,false,xyfb,Form,lns,jvy);}};gzl.DeleteSelectedObjects=function(wqhb,qshb){var vgz=new Array();var qpj=new Array();var qsg=this.m_sAltErrText;qpj=this.getSelectedRows().toString().split(",");for(var ykqb=0;(ykqb<qpj.length);ykqb++){var rdl=this.getCellValue(this.m_nDeleteColumn,qpj[ykqb]);vgz.push(rdl);}var bpmb=bj(this.m_sDeleteURL);bpmb.setParameter("IDs",vgz);bpmb.response=function(){var pxhb=this.getResponseXML();var wjd=wddb(pxhb,"result");var cvn=zpq(pxhb,"ResultText");svb(false);if((wjd!=undefined)&&(wjd!=wxcb))fdb(zcmb(wjd,qsg,cvn));if(wqhb.m_fnOnDeleteDone!=undefined){wqhb.m_fnOnDeleteDone(wjd,vgz);wqhb.m_fnOnDeleteDone=undefined;}};bpmb.request(null);if(qshb)svb(true);else{sld(mmrb);xvpb(sft,rvk);}this.setSelectedRows([-1]);};gzl.OnDeleteObjects=function(wqhb,qshb){if(wqhb.m_fnOnConfirmDelete!=undefined){wqhb.m_fnOnConfirmDelete();wqhb.m_fnOnConfirmDelete=undefined;}wqhb.DeleteSelectedObjects(wqhb,qshb);};gzl.OnDeleteObject=function(qcm,wrp,gvj,trh,dkrb,szk,fdp){if((this.getSelectedRows()!="")&&(this.getSelectedRows()!=-1)){var qpj=new Array();qpj=this.getSelectedRows().toString().split(",");if(qpj.length>0){this.m_sDeleteURL=cqqb+qcm;this.m_sAltErrText=fdp;this.m_fnOnConfirmDelete=dkrb;this.m_fnOnDeleteDone=trh;if(wrp!=undefined)grm(wrp,this.OnDeleteObjects,szk,this,undefined,undefined,true);else this.OnDeleteObjects(this,true);}else slc(gvj);}else slc(gvj);};gzl.InitObjectMove=function(bsc,gyw,zgjb){hdkb(bsc,[ypr,mrlb,lndb,cbkb],this);this.m_asArrowIds=bsc;this.m_sMoveStr=gyw;this.m_fnOnGetEditObj=zgjb;this.onSelectedRowsChanged([]);};gzl.MoveObject=function(zwrb){var vtnb=this.getSelectedRows();var gzg=this.m_sMoveStr;if((gzg.search(eval("/\\$EDIT_OBJECT_ID\\$/"))>=0)&&(this.m_fnOnGetEditObj!=undefined))gzg=gzg.replace(eval("/\\$EDIT_OBJECT_ID\\$/"),this.m_fnOnGetEditObj());if(vtnb.length==1){var jlkb=this.GetSelectedObjectID();if(jlkb>0){var syq=bj(zwrb+"="+gzg+"."+jlkb);pcp(true);this.m_bSaving=true;syq.response=function(){var wjd=tdh(this,true);var cvn=vjfb(this);if(wjd!=wxcb){pcp(false);this.m_bSaving=false;fdb(zcmb(0,"",cvn));}};if(syq)syq.request();}}};gzl.onSelectedRowsChanged=function(vtnb){if(this.m_asArrowIds!=undefined){var ghcb=["hidden","hidden"];if((vtnb.length==1)&&(vtnb[0]!=-1)&&!this.m_DisableMove){if(vtnb[0]!=0)ghcb[0]="visible";if(vtnb[0]!=(this.getRowCount()-1))ghcb[1]="visible";}document.getElementById(this.m_asArrowIds[0]).style.visibility=ghcb[0];document.getElementById(this.m_asArrowIds[1]).style.visibility=ghcb[0];document.getElementById(this.m_asArrowIds[2]).style.visibility=ghcb[1];document.getElementById(this.m_asArrowIds[3]).style.visibility=ghcb[1];}};gzl.GetObjectID=function(lqkb,kpx){var ksm=0;for(var ykqb=0;ykqb<this.getRowCount();ykqb++){if(this.getCellText(kpx,ykqb)==lqkb){ksm=parseInt(this.getCellText((this.m_nNumColumns-1),ykqb));break;}}return(ksm);};gzl.GetSelectedObjectID=function(){var vtnb=this.getSelectedRows();var ksm=-1;if(vtnb.length)ksm=parseInt(this.getCellText((this.m_nNumColumns-1),vtnb[0]));return(ksm);};gzl.DisableSorting=function(gxk){this.m_DisableMove=false;if(this.onHeaderClickedDef==undefined)this.onHeaderClickedDef=this.onHeaderClicked;if(gxk!=undefined)this.onHeaderClicked=function(Event,ykqb){gxk(ykqb);};else this.onHeaderClicked=function(Event,ykqb){return(true);};this.setSortColumn(-1);};gzl.EnableSorting=function(){this.m_DisableMove=true;this.onSelectedRowsChanged(-1);this.onHeaderClicked=this.onHeaderClickedDef;this.setSortColumn(1);};gzl.Reset=function(qwgb){var dzfb=this.getSelectionMode();var vlnb=[];for(var ykqb=0;ykqb<(this.m_nNumColumns-1);ykqb++)vlnb[ykqb]=this.getCellFormat(ykqb);this.saveColSortColumn=this.getSortColumn();this.saveSortDirection=this.getSortDirection(this.getSortColumn());this.clearCurrentModel();this.clearRowModel();this.clearScrollModel();this.clearSelectionModel();this.clearSortModel();this.setSelectionMode(dzfb);this.setCellFormat(vlnb);this.m_bInitialUpdate=true;this.refresh();if(qwgb)xzgb(this);};gzl.clearScrollModelDef=gzl.clearScrollModel;gzl.clearScrollModel=function(){if(!this.m_bUpdating)this.clearScrollModelDef();};gzl.CheckErrorState=function(wtz,kpvb){var qg=[];var kgw=[];var qxy="";var vxs="";if((qg=kpvb.GetCollectionByAttrib("var","name","Result"))&&(qg.length)&&((qxy=kpvb.GetNodeValue(qg[0],"val"))!="0")){kgw=kpvb.GetCollectionByAttrib("var","name","ResultText");vxs=kpvb.GetNodeValue(kgw[0],"val");rqc(this.m_sDialog);fdb(zcmb(0,"",vxs),true);}};gzl.FilterGrid=function(rch,ckdb,qfjb,xjk){var vc,xjbb=[];this.m_bFilterMode=qfjb;this.m_OriginalRowCount=this.m_XMLTable.getCount();this.m_sSearchVal=rch;this.m_nColPos=ckdb;this.m_bAllowEmpty=(xjk==undefined)?false:xjk;var mpk="";var dwnb=false;var jmvb;var fbt;var mzh;var dkkb=false;mpk=rch.toLowerCase();fbt=mpk.length;mzh=mpk.indexOf("*");if(mzh!=-1){dwnb=true;}var wgj=mpk.match(eval("/\\[\\b[a-zA-Z0-9_]+\\b\]/g"));var xrhb=-1;if(wgj){xrhb=mpk.replace(eval("/\\[\\b[a-zA-Z0-9_]+\\b\]/g"),"1").length;}if(xrhb>-1){fbt=xrhb;}mpk=mpk.replace(eval("/\\./g"),"\\.");mpk=mpk.replace(eval("/\\*/g"),"(.*)");mpk=mpk.replace(eval("/\\_/g"),"\\_");mpk=mpk.replace(eval("/\\?/g"),".");for(vc=0;vc<this.m_OriginalRowCount;vc++){lnbb=this.getCellValue(ckdb,vc);wwc=false;var nsjb=false;if(lnbb.toLowerCase().search(eval("/"+mpk+"/"))==0){if(dwnb)nsjb=true;else if(lnbb.length==fbt)nsjb=true;}if(xjk&&(lnbb==""||lnbb==undefined))nsjb=true;if(nsjb||mpk=="")xjbb.push(vc);}this.setRowCount(xjbb.length);this.setRowIndices(xjbb);};};