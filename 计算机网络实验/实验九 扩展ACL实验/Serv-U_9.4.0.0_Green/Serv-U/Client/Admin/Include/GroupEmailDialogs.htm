%PRIV_GROUP_ADMIN%
<!--#include "..\Strings\Strings.strings"-->
<!--#include "..\..\Common\Strings\Strings.strings"-->
<div id="GroupEmailListinner" style="display:none;"><div id="EmailGroups" style="padding:0 5px 0 5px;"><div style="display:inline;"><img alt="$GROUP_EMAIL_LIST_DIALOG_TITLE$" src="%COMMON_FILE%Images/GroupEmail32.png" width="32" height="32" class="header-icon" />$EMAIL_GROUPS_INFO$<div style='clear:both;height:5px;overflow:hidden;'></div></div><table class=""><tr><td style="vertical-align:top;width:220px;"><span id="EmailGroupsList"></span></td><td style="text-align:center;width:60px;"><div><span id="AddEmailGroupButton"></span></div><div><span id="RemoveEmailGroupButton"></span></div></td><td style="vertical-align:top;width:220px;"><span id="EmailSelectGroupsList"></span></td></tr></table><div style="text-align:right;padding:10px 20px 0 0;"><span id="OKEmailGroupButton"></span><span id="CancelEmailGroupButton"></span></div></div></div><script type="text/javascript" language="javascript">var hkp;vphb("$GROUP_EMAIL_LIST_DIALOG_TITLE$","GroupEmailList","525","335","","$CLOSE_CANCEL$","GroupEmail16.png");function ys(cqg){hkp=cqg[0];crcb.EnableUpdates(false);kkg.setSelectedRows([-1]);plz.setSelectedRows([-1]);if(hkp=="To"){zbv="ToGroupName";plz.EnableUpdates(true,"%SELECT_GROUP_EMAIL_OBJECT%","ToGroups.xml&ID="+xrx);kkg.ForceUpdate("%GROUP_EMAIL_OBJECT%","EmailToGroups.xml&ID="+xrx);}else{zbv="BccGroupName";plz.EnableUpdates(true,"%SELECT_GROUP_EMAIL_OBJECT%","BCCGroups.xml&ID="+xrx);kkg.ForceUpdate("%GROUP_EMAIL_OBJECT%","EmailBCCGroups.xml&ID="+xrx);}xvpb(rvk,"GroupEmailList",xqc);}function gwgb(){if(hkp=="To"){kkg.ForceUpdate("%GROUP_EMAIL_OBJECT%","EmailToGroups.xml&ID="+xrx);}else{kkg.ForceUpdate("%GROUP_EMAIL_OBJECT%","EmailBCCGroups.xml&ID="+xrx);}}function kds(){if(hkp=="To"){zbv="ToGroupName";}else{zbv="BccGroupName";}kkg.OnDeleteObject("Result.xml%DELETE_OBJECT_REF%CSUEvent."+xrx+"."+zbv,undefined,"$SELECT_ONE_GROUP_EMAIL_DELETE$",gwgb);}function xqc(){kkg.EnableUpdates(false);plz.EnableUpdates(false);crcb.EnableUpdates(true);kky(kkg,true);kky(plz,true);}function scn(){rqc('GroupEmailList');kkg.EnableUpdates(false);plz.EnableUpdates(false);crcb.EnableUpdates(true);kky(kkg,true);kky(plz,true);}function vpj(){if((plz.getSelectedRows()!="")&&(plz.getSelectedRows()!=-1)){var vgz=new Array();var mgsb="";wvdb=plz.getSelectedRows().toString().split(",");for(var ykqb=0;(ykqb<wvdb.length);ykqb++){var grl=plz.getCellText(0,wvdb[ykqb]);vgz.push(grl);}if(hkp=="To"){zbv="ToGroupName";}else{zbv="BccGroupName";}var kdb=bj("%ADMIN_FILE%XML/Result.xml?Command=ObjectCommand&Object=CSUEvent."+xrx+".AddGroupNames");kdb.setParameter("Class","C"+zbv);kdb.setParameter("GroupName",vgz);kdb.response=function(){var pxhb=this.getResponseXML();var wjd=wddb(pxhb,"result");var cvn=zpq(pxhb,"ResultText");pcp(false);if((wjd!=undefined)&&(wjd!=wxcb))fdb(zcmb(0,"",cvn));if(hkp=="To"){kkg.ForceUpdate("%GROUP_EMAIL_OBJECT%","EmailToGroups.xml&ID="+xrx);}else{kkg.ForceUpdate("%GROUP_EMAIL_OBJECT%","EmailBCCGroups.xml&ID="+xrx);}};pcp(true);kdb.request(null);}else fdb("$SELECT_ONLY_ONE_EMAIL_GROUP$");}var flsb=nmd("","AddEmailGroupButton",vpj,undefined,undefined,undefined,"GreenLeftArrow");var mlnb=nmd("","RemoveEmailGroupButton",kds,undefined,undefined,undefined,"GreenRightArrow");flsb.setStyle("visibility","hidden");mlnb.setStyle("visibility","hidden");var kkg=lqp("EmailGroupsList",["$GROUP_EMAIL_LIST_DIALOG_TITLE$"],[210],"%GROUP_EMAIL_OBJECT%","groups","group",2);kkg.setStyle("height","200");kkg.onSelectedRowsChangedDef=kkg.onSelectedRowsChanged;kkg.onSelectedRowsChanged=function(vtnb){if((vtnb.length>=1)&&(vtnb[0]!=-1)){mlnb.setStyle("visibility","visible");plz.setSelectedRows([-1]);}else mlnb.setStyle("visibility","hidden");this.onSelectedRowsChangedDef(vtnb);};kkg.getCellImage=function(hfmb,xwf){return("Group");};var plz=lqp("EmailSelectGroupsList",["$SELECT_GROUP_DIALOG_TITLE$"],[210],"%SELECT_GROUP_EMAIL_OBJECT%","groups","group",2,vpj);plz.setStyle("height","200");plz.onSelectedRowsChangedDef=plz.onSelectedRowsChanged;plz.onSelectedRowsChanged=function(vtnb){if((vtnb.length>=1)&&(vtnb[0]!=-1)){flsb.setStyle("visibility","visible");kkg.setSelectedRows([-1]);}else flsb.setStyle("visibility","hidden");this.onSelectedRowsChangedDef(vtnb);};plz.getCellImage=function(hfmb,xwf){return("Group");};wvg("$CANCEL_BUTTON$","CancelEmailGroupButton",scn);wvg("$OK_BUTTON$","OKEmailGroupButton",scn);</script>